<!-- 
    HTML for the custom avatar selector page
-->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width" />
    <!-- Normalize, Bootstrap, and Font Awesome core CSS -->
    <!-- Latest compiled and minified CSS -->
    <link
      rel="stylesheet"
      href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
    />

    <!-- jQuery library -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

    <!-- Popper JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>

    <!-- Latest compiled JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <title></title>

    <!-- Custom CSS and JS imports -->
    <!-- <meta name="viewport" content="width=device-width, initial-scale=1.0"> -->
    <meta name="viewport" content="width=device-width" />
    <link
      rel="stylesheet"
      href="/static/CSS/universal.css"
    />
    <!-- Change the tab icon -->
    <link rel = ' shortcut icon' href = "/static/images/morse.png"/>
    
<!-- Import custom sheets and JS-->
<link rel = 'stylesheet' href = "/static/CSS/read_page.css"> 
<link rel = 'stylesheet' href = "/static/CSS/avatars.css">   

<!-- 
    JS mainly for the post request.
    Post request which sends the new avatar which the user has selected
    to be saved in the User database. After the response returns to the 
    user the profile page is loaded again. 
-->
<script>
    //function for post request to db to save new avatar id selection
    function saveAvatar(avatar_num){
        if (avatar_num==0){
            //if nothing is selected and apply is clicked, return to profile and no request sent
            window.open('/profile', "_self"); 
        }else {
        fetch('/avatarChange', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body:JSON.stringify(avatar_num)
        })

        .then(function(response){
            window.open('/profile', "_self");
            return response.text()
        })
        .then(function(text){
            return console.log(text)    //console log of the request response
        }
        )}
    }
</script>


    <!--FONTS -->
    <link rel="preconnect" href="https://fonts.gstatic.com" />
    <link
      href="https://fonts.googleapis.com/css2?family=Fira+Code&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css?family=Fira%20Mono"
    />
  </head>
  <body>
    <nav class="navbar navbar-dark navbar-expand-lg sticky-top">
      <a class="navbar-brand" href="/">
        <img src="../static/images/morse.png" class="logo">
        Learn Morse</a>
      <button
        class="navbar-toggler"
        type="button"
        data-toggle="collapse"
        data-target="#navbarText"
        aria-controls="navbarText"
        aria-expanded="false"
        aria-label="Toggle navigation"
      >
        <span class="navbar-toggler-icon"></span>
      </button>
      <div
        class="collapse navbar-collapse"
        id="navbarText"
        id="navbarSupportedContent"
      >
        <ul class="navbar-nav mr-auto">
          <li class="nav-item dropdown">
            <a
              class="nav-link"
              href="#"
              id="navbarDropdownMenuLink"
              data-toggle="dropdown"
              aria-haspopup="true"
              aria-expanded="false"
            >
              Play
            </a>
            <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
              <a class="dropdown-item" href="/play/flashcards">
                Flashcards
              </a>
              <a class="dropdown-item" href="/play/write">Write</a>
              <a class="dropdown-item" href="/play/read">Read</a>
              <a class="dropdown-item" href="/play/listen"> Listen </a>
            </div>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/learn">Learn </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/about">About </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/profile">Profile </a>
          </li>
        </ul>
        <ul class="navbar-nav">
          
          <li class="nav-item">
            <a class="nav-link" href="/login">Login</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/signup">Signup</a>
          </li>
          
        </ul>
      </div>
    </nav>

    
<!-- content -->
<div class = 'content-flex' style = 'height: 100%'>
    <div class = 'container'></div>
    <!-- heading row -->
        <div class = 'row'>
            <h1 style= "text-align: center; width:100%"> Select an Avatar </h1>
        </div>
        <!-- row for the avatar faces-->
        <div class = 'row' style= 'margin: 10%'>
            <div class = 'col-md-1'></div>
            <!-- all col-md-2 is a picture frame for the 5 different avatars -->
            <div class = 'col-md-2'>
                <!-- Avatar 1-->
                <p class = 'imagBox' id = 'av1'>
                    <img src = '/static/images/avatar1.png'>
                </p>
                <p>Avatar 1</p>
            </div>
            <div class = 'col-md-2'>
                <!-- Avatar 2-->
                <p class = 'imagBox' id = 'av2'>
                    <img src = '/static/images/avatar2.png'>
                </p>
                <p>Avatar 2</p>
            </div>
            <div class = 'col-md-2'>
                <!-- Avatar 3-->
                <p class = 'imagBox' id = 'av3'>
                    <img src = '/static/images/avatar3.png'>
                </p>
                <p>Avatar 3</p>
            </div>
            <div class = 'col-md-2'>
                <!-- Avatar 4-->
                <p class = 'imagBox' id = 'av4'>
                    <img src = '/static/images/avatar4.png'>
                </p>
                <p>Avatar 4</p>
            </div>
            <div class = 'col-md-2'>
                <!-- Avatar 5-->
                <p class = 'imagBox' id = 'av5'>
                    <img src = '/static/images/avatar5.png'>
                </p>
                <p>Avatar 5</p>
            </div>
            <div class = 'col-md-1'></div>
        </div>
        <!-- row for the apply and the cancel button-->
        <div class = 'row'>
            <div class = 'col-md-4'></div>
            <div class = 'col-md-2'>
                <!-- Apply button -->
                <p class = 'buttons_read' onclick = saveAvatar(selectedAvatar)> Apply </p>
            </div>
            <div class = 'col-md-2'>
                <!-- Cancel button -->
                <a href = '/profile'><p class = 'buttons_read'> Cancel </p></a>
            </div>
            <div class = 'col-md-4'></div>
        </div>
    </div>
</div>

<script>
    // script to change the background of the currently selected avatar 
    var ids = ['av1','av2','av3','av4','av5'];
    var selectedAvatar = 0;
    var id_num = {
        'av1':1,'av2':2,'av3':3,'av4':4,'av5':5
    };

    //reset the background of all the avatars and then set the selected to pink
    function resetBack(id) {
        ids.forEach( function(temp) {
            document.getElementById(temp).style.backgroundColor='white';
        })
        document.getElementById(id).style.backgroundColor = '#d83452';
        selectedAvatar = id_num[id] //save the selected avatar id
    }

    //event listeners for each of the picture frames
    document.getElementById('av1').onclick = function() {resetBack('av1')};
    document.getElementById('av2').onclick = function() {resetBack('av2')};
    document.getElementById('av3').onclick = function() {resetBack('av3')};
    document.getElementById('av4').onclick = function() {resetBack('av4')};
    document.getElementById('av5').onclick = function() {resetBack('av5')};
</script> 



    <!-- Default vs custom footer-->
    
    <!-- Standard footer -->
    <footer class="morse">
      <div class="links">
        <div class="linkgroup">
          <span style="font-weight: bolder">BRAND</span>
          <a href="/">Home</a>
          <a href="/about">About</a>
        </div>
        <div class="linkgroup">
          <span style="font-weight: bolder;">USER</span>
          <a href="/learn">Learn</a>
          <a href="/profile">Profile</a>
        </div>
        <div class="linkgroup">
          <span style="font-weight: bolder;">PLAY</span>
          <a href="/play/flashcards">Flashcards</a>
          <a href="/play/write">Write</a>
        </div>
        <div class="linkgroup">
          <span style="visibility: hidden;">line</span>
          <a href="/play/read">Read</a>
          <a href="/play/listen">Listen</a>
        </div>
        </div>
      </div>
      <div id="logo-block">
        <img src="../static/images/morse.png" class="logo-black">
        <span style="padding:10px">
          Learn Morse (2021)
        </span>
      </div>
    </div>
  </footer>
    
  </body>
</html>